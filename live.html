<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Stream | HoopyStreams</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-black text-white">
    <!-- Ad Scripts -->
    <script>(function(d,z,s){s.src='https://'+d+'/401/'+z;try{(document.body||document.documentElement).appendChild(s)}catch(e){}})('gizokraijaw.net',9185895,document.createElement('script'))</script>
    <script>(function(s,u,z,p){s.src=u,s.setAttribute('data-zone',z),p.appendChild(s);})(document.createElement('script'),'https://shebudriftaiter.net/tag.min.js',9185887,document.body||document.documentElement)</script>
    <script>(function(d,z,s){s.src='https://'+d+'/401/'+z;try{(document.body||document.documentElement).appendChild(s)}catch(e){}})('groleegni.net',9185886,document.createElement('script'))</script>

    <!-- Navbar -->
    <nav class="bg-neutral-900 fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="https://hoopystreams.com" class="text-2xl font-bold text-white" data-ad-state="0">HoopyStreams</a>
                <div class="hidden md:block flex-grow">
                    <div class="flex items-baseline justify-center space-x-6">
                        <a href="https://hoopystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">NBA</a>
                        <a href="https://hoopystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">NCAA</a>
                        <a href="https://rushystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">NFL</a>
                        <a href="https://rushystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">CFB</a>
                        <a href="https://battystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">MLB</a>
                        <a href="https://footystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">SOCCER</a>
                        <a href="https://trackystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">F1</a>
                        <a href="https://fightystreams.com" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">UFC</a>
                        <a href="/blog" class="hover:text-red-600 px-3 py-2 text-sm font-medium" data-ad-state="0">BLOG</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button type="button" class="text-white hover:text-red-600 p-2" data-ad-state="0">
                        <span class="sr-only">Open menu</span>
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 px-4 max-w-7xl mx-auto">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold">Live Stream</h1>
            <p class="text-gray-400 text-sm mt-2">Select your preferred server below</p>
        </div>

        <div id="stream-container" class="w-full flex flex-col items-center">
            <div id="server-buttons" class="flex flex-wrap justify-center gap-4 mb-6">
                <!-- Server buttons will be injected here -->
            </div>
            <div class="flex flex-col md:flex-row justify-between w-full">
                <!-- Left Banner -->
                <div class="hidden md:block w-[120px] lg:w-[160px] h-[600px] bg-neutral-900" id="leftBanner"></div>
                
                <div id="player-container" class="w-full md:max-w-[calc(100%-260px)] lg:max-w-[calc(100%-340px)] flex justify-center">
                    <!-- Stream will be injected here -->
                </div>
                
                <!-- Right Banner -->
                <div class="hidden md:block w-[120px] lg:w-[160px] h-[600px] bg-neutral-900" id="rightBanner"></div>
            </div>
        </div>
    </main>

    <script>
        const params = new URLSearchParams(window.location.search);
        const gameId = params.get('game');

        const streamMap = {
            flahou: [
                "https://hd.redditf.xyz/live/embed.php?ch=ch14",
                "https://hd.redditf.xyz/live/embed.php?ch=ch14", 
                "https://hd.redditf.xyz/live/embed.php?ch=ch14"
            ]
        };

        const container = document.getElementById('stream-container');
        const buttonsContainer = document.getElementById('server-buttons');
        const playerContainer = document.getElementById('player-container');

        let currentStreamIndex = 0;

        function createIframe(src) {
            const iframe = document.createElement('iframe');
            iframe.src = src;
            iframe.className = 'w-full aspect-video rounded-xl border border-neutral-700 shadow-lg';
            iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
            iframe.allowFullscreen = true;
            return iframe;
        }

        function handleAdSequence(element, callback) {
            const currentState = parseInt(element.dataset.adState) || 0;
            
            if (currentState === 0) {
                // First click - trigger pop-under
                const popUnderEvent = new Event('popunder');
                document.dispatchEvent(popUnderEvent);
                element.dataset.adState = "1";
                return;
            }
            
            if (currentState === 1) {
                // Second click - trigger interstitial
                const interstitialEvent = new Event('interstitial');
                document.dispatchEvent(interstitialEvent);
                element.dataset.adState = "2";
                return;
            }
            
            if (currentState === 2) {
                // Third click - execute callback and reset
                callback();
                element.dataset.adState = "0";
            }
        }

        // Add click handlers to all navigation links
        document.querySelectorAll('a, button').forEach(element => {
            const originalHref = element.href;
            const originalOnClick = element.onclick;
            
            element.onclick = (e) => {
                e.preventDefault();
                handleAdSequence(element, () => {
                    if (originalOnClick) {
                        originalOnClick.call(element);
                    } else if (originalHref) {
                        window.location.href = originalHref;
                    }
                });
            };
        });

        if (streamMap[gameId]) {
            // Create server buttons
            streamMap[gameId].forEach((stream, index) => {
                const button = document.createElement('button');
                button.textContent = `Server ${index + 1}`;
                button.className = 'px-6 py-2 rounded-lg bg-neutral-800 hover:bg-red-600 transition duration-300';
                button.dataset.adState = "0";
                button.onclick = (e) => {
                    e.preventDefault();
                    handleAdSequence(button, () => {
                        currentStreamIndex = index;
                        playerContainer.innerHTML = '';
                        playerContainer.appendChild(createIframe(stream));
                    });
                };
                buttonsContainer.appendChild(button);
            });

            // Create refresh button
            const refreshButton = document.createElement('button');
            refreshButton.textContent = 'Refresh';
            refreshButton.className = 'px-6 py-2 rounded-lg bg-neutral-800 hover:bg-red-600 transition duration-300';
            refreshButton.dataset.adState = "0";
            refreshButton.onclick = (e) => {
                e.preventDefault();
                handleAdSequence(refreshButton, () => {
                    const currentStream = streamMap[gameId][currentStreamIndex];
                    playerContainer.innerHTML = '';
                    playerContainer.appendChild(createIframe(currentStream));
                });
            };
            buttonsContainer.appendChild(refreshButton);

            // Load first stream by default
            playerContainer.appendChild(createIframe(streamMap[gameId][0]));
        } else {
            // Show error message
            container.innerHTML = `
                <div class="bg-neutral-900 rounded-xl p-8 text-center max-w-[90%] w-full border border-neutral-700">
                    <i class="fas fa-exclamation-circle text-4xl text-red-600 mb-4"></i>
                    <h2 class="text-xl font-semibold mb-2">No Stream Found</h2>
                    <p class="text-gray-400">We couldn't find a stream for this game.</p>
                    <a href="/" class="inline-block mt-4 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition duration-300" data-ad-state="0">
                        Return Home
                    </a>
                </div>
            `;
        }
    </script>
</body>
</html>
